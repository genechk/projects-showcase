import * as L from 'leaflet'

import { statuses } from '@dkc:content'

export const getAppealsMarker = (
  latLng: L.LatLng,
  markerType = '',
  appealId = '',
) => {
  switch (markerType) {
    case statuses.inProgress:
      return getDefaultAppealsMarker(latLng, 'in-progress', appealId)

    case statuses.completed:
      return getDefaultAppealsMarker(latLng, 'done', appealId)

    case statuses.noAnswer:
      return getDefaultAppealsMarker(latLng, 'neutral', appealId)

    case statuses.obsolete:
      return getDefaultAppealsMarker(latLng, 'unactual', appealId)

    case statuses.partial:
      return getDefaultAppealsMarker(latLng, 'actual', appealId)

    case statuses.reject:
      return getDefaultAppealsMarker(latLng, 'reject', appealId)

    case statuses.blacklist:
      return getDefaultAppealsMarker(latLng, 'blacklist', appealId)

    case statuses.verified:
      return getDefaultAppealsMarker(latLng, 'actual', appealId)

    default:
      return getDefaultAppealsMarker(latLng, 'not-started', appealId)
  }
}

const getDefaultAppealsMarker = (
  latLng: L.LatLng,
  className = 'not-started',
  appealId = '',
) =>
  L.marker(latLng, {
    riseOnHover: true,
    icon: getMapPinSvgIcon(className, appealId),
  })

const getMapPinSvgIcon = (className = 'neutral', appealId: string) => {
  const appealLabel = appealId
    ? `<div class="appeal-label appeal-label-${className}">${appealId}</div>`
    : ''

  switch (className) {
    case 'done':
      return getDefaultMapPinIcon(
        `
        <path class="map-pin-fill" fill-rule="evenodd" clip-rule="evenodd" d="M5.49103 27.1756C-0.497009 21.1876 -0.497009 11.4791 5.49103 5.49103C11.4791 -0.49701 21.1876 -0.49701 27.1756 5.49103C33.1637 11.4791 33.1637 21.1876 27.1756 27.1756L17.7444 36.6069C16.9633 37.388 15.7034 37.388 14.9224 36.607L5.49103 27.1756Z" />
        <path class="map-pin-ring" fill="white" fill-rule="evenodd" clip-rule="evenodd" d="M4.78392 4.78392C11.1625 -1.59464 21.5042 -1.59464 27.8827 4.78392C34.2613 11.1625 34.2613 21.5042 27.8827 27.8827L18.4515 37.314C17.2799 38.4855 15.3869 38.4857 14.2153 37.3141L4.78392 27.8827C-1.59464 21.5042 -1.59464 11.1625 4.78392 4.78392ZM26.4685 6.19814C20.871 0.600621 11.7957 0.600621 6.19814 6.19814C0.600621 11.7957 0.600621 20.871 6.19814 26.4685L15.6295 35.8999C16.02 36.2904 16.6467 36.2904 17.0373 35.8998L26.4685 26.4685C32.066 20.871 32.066 11.7957 26.4685 6.19814Z" />
        <path fill="white" fill-rule="evenodd" clip-rule="evenodd" d="M24.6653 12.3515C25.1116 12.8201 25.1116 13.5799 24.6653 14.0485L15.5224 23.6485C15.0761 24.1172 14.3525 24.1172 13.9062 23.6485L9.33474 18.8485C8.88842 18.3799 8.88842 17.6201 9.33474 17.1515C9.78105 16.6828 10.5047 16.6828 10.951 17.1515L14.7143 21.1029L23.049 12.3515C23.4953 11.8828 24.219 11.8828 24.6653 12.3515Z" />
        `,
        className,
        appealLabel,
      )
    case 'not-started':
      return getDefaultMapPinIcon(
        `
        <path class="map-pin-fill" fill-rule="evenodd" clip-rule="evenodd" d="M5.49102 27.1756C-0.497014 21.1876 -0.497014 11.4791 5.49102 5.49103C11.4791 -0.497009 21.1876 -0.497009 27.1756 5.49103C33.1637 11.4791 33.1637 21.1876 27.1756 27.1756L17.7444 36.6069C16.9633 37.388 15.7034 37.388 14.9224 36.607L5.49102 27.1756Z" />
        <path class="map-pin-ring" fill="white" fill-rule="evenodd" clip-rule="evenodd" d="M4.78392 4.78392C11.1625 -1.59464 21.5042 -1.59464 27.8827 4.78392C34.2613 11.1625 34.2613 21.5042 27.8827 27.8827L18.4515 37.314C17.2799 38.4855 15.3869 38.4857 14.2153 37.3141L4.78392 27.8827C-1.59464 21.5042 -1.59464 11.1625 4.78392 4.78392ZM26.4685 6.19814C20.871 0.600621 11.7957 0.600621 6.19814 6.19814C0.600621 11.7957 0.600621 20.871 6.19814 26.4685L15.6295 35.8999C16.02 36.2904 16.6467 36.2904 17.0373 35.8998L26.4685 26.4685C32.066 20.871 32.066 11.7957 26.4685 6.19814Z"/>
        <path fill="white" fill-rule="evenodd" clip-rule="evenodd" d="M15.8604 13.3333C14.0532 13.3333 12.7556 14.1573 12.339 14.9973C12.0499 15.5802 11.3182 15.83 10.7047 15.5553C10.0913 15.2807 9.82836 14.5855 10.1175 14.0027C11.0493 12.1239 13.3904 11 15.8604 11C17.4567 11 18.9492 11.4596 20.0702 12.2585C21.1917 13.0576 22 14.2506 22 15.6667C22 18.0809 19.748 19.7596 17.3126 20.2035C17.2234 20.2197 17.1523 20.2617 17.1136 20.3007C17.0961 20.3183 17.0899 20.3303 17.0885 20.3335C17.0885 20.3337 17.0884 20.3338 17.0883 20.334C17.088 20.978 16.5383 21.5 15.8604 21.5C15.1822 21.5 14.6325 20.9777 14.6325 20.3333C14.6325 19.0009 15.7494 18.1125 16.8499 17.9119C18.6585 17.5823 19.5442 16.5178 19.5442 15.6667C19.5442 15.1497 19.253 14.5928 18.5967 14.1251C17.9401 13.6572 16.9767 13.3333 15.8604 13.3333ZM14.6324 23.8333C14.6324 23.189 15.1822 22.6667 15.8603 22.6667H15.8726C16.5508 22.6667 17.1005 23.189 17.1005 23.8333C17.1005 24.4777 16.5508 25 15.8726 25H15.8603C15.1822 25 14.6324 24.4777 14.6324 23.8333Z" />
        `,
        className,
        appealLabel,
      )
    case 'actual':
      return getDefaultMapPinIcon(
        `
        <path class="map-pin-fill" fill-rule="evenodd" clip-rule="evenodd" d="M5.49102 27.1756C-0.497014 21.1876 -0.497014 11.4791 5.49102 5.49103C11.4791 -0.497009 21.1876 -0.497009 27.1756 5.49103C33.1637 11.4791 33.1637 21.1876 27.1756 27.1756L17.7444 36.6069C16.9633 37.388 15.7034 37.388 14.9224 36.607L5.49102 27.1756Z" />
        <path class="map-pin-ring" fill="white" fill-rule="evenodd" clip-rule="evenodd" d="M4.78392 4.78392C11.1625 -1.59464 21.5042 -1.59464 27.8827 4.78392C34.2613 11.1625 34.2613 21.5042 27.8827 27.8827L18.4515 37.314C17.2799 38.4855 15.3869 38.4857 14.2153 37.3141L4.78392 27.8827C-1.59464 21.5042 -1.59464 11.1625 4.78392 4.78392ZM26.4685 6.19814C20.871 0.600621 11.7957 0.600621 6.19814 6.19814C0.600621 11.7957 0.600621 20.871 6.19814 26.4685L15.6295 35.8999C16.02 36.2904 16.6467 36.2904 17.0373 35.8998L26.4685 26.4685C32.066 20.871 32.066 11.7957 26.4685 6.19814Z"/>
        <path fill="white" fill-rule="evenodd" clip-rule="evenodd" d="M16 11C16.6627 11 17.2 11.5373 17.2 12.2V15.8L20.8 15.8C21.4627 15.8 22 16.3373 22 17C22 17.6627 21.4627 18.2 20.8 18.2H17.2V21.8C17.2 22.4627 16.6627 23 16 23C15.3373 23 14.8 22.4627 14.8 21.8V18.2H11.2C10.5373 18.2 10 17.6627 10 17C10 16.3373 10.5373 15.8 11.2 15.8L14.8 15.8V12.2C14.8 11.5373 15.3373 11 16 11Z"/>
        `,
        className,
        appealLabel,
      )
    case 'in-progress':
      return getDefaultMapPinIcon(
        `
        <path class="map-pin-fill" fill-rule="evenodd" clip-rule="evenodd" d="M5.49102 27.1756C-0.497014 21.1876 -0.497014 11.4791 5.49102 5.49103C11.4791 -0.497009 21.1876 -0.497009 27.1756 5.49103C33.1637 11.4791 33.1637 21.1876 27.1756 27.1756L17.7444 36.6069C16.9633 37.388 15.7034 37.388 14.9224 36.607L5.49102 27.1756Z"/>
        <path class="map-pin-ring" fill="white" fill-rule="evenodd" clip-rule="evenodd" d="M4.78392 4.78392C11.1625 -1.59464 21.5042 -1.59464 27.8827 4.78392C34.2613 11.1625 34.2613 21.5042 27.8827 27.8827L18.4515 37.314C17.2799 38.4855 15.3869 38.4857 14.2153 37.3141L4.78392 27.8827C-1.59464 21.5042 -1.59464 11.1625 4.78392 4.78392ZM26.4685 6.19814C20.871 0.600621 11.7957 0.600621 6.19814 6.19814C0.600621 11.7957 0.600621 20.871 6.19814 26.4685L15.6295 35.8999C16.02 36.2904 16.6467 36.2904 17.0373 35.8998L26.4685 26.4685C32.066 20.871 32.066 11.7957 26.4685 6.19814Z"/>
        <path fill="white" fill-rule="evenodd" clip-rule="evenodd" d="M24.9514 17.941L21.9675 17.631C21.9889 17.4245 22 17.2141 22 17C22 16.7859 21.9889 16.5755 21.9675 16.369L24.9514 16.059C24.9835 16.3683 25 16.6822 25 17C25 17.3178 24.9835 17.6317 24.9514 17.941ZM24.2239 13.3384L21.484 14.5601C21.3128 14.1762 21.1019 13.8127 20.8561 13.475L23.2817 11.7096C23.6497 12.2153 23.9664 12.7608 24.2239 13.3384ZM21.2904 9.71828L19.5251 12.1439C19.1874 11.8981 18.8238 11.6872 18.4399 11.516L19.6616 8.77608C20.2392 9.03364 20.7847 9.35027 21.2904 9.71828ZM16.941 8.04861L16.631 11.0325C16.4245 11.0111 16.2141 11 16 11C15.7859 11 15.5755 11.0111 15.369 11.0325L15.059 8.04861C15.3683 8.01647 15.6822 8 16 8C16.3178 8 16.6318 8.01647 16.941 8.04861ZM7.77609 20.6616L10.516 19.4399C10.6873 19.8238 10.8981 20.1873 11.1439 20.525L8.71829 22.2904C8.35028 21.7847 8.03365 21.2392 7.77609 20.6616ZM10.7096 24.2817L12.475 21.8561C12.8127 22.1019 13.1762 22.3128 13.5602 22.484L12.3384 25.2239C11.7608 24.9664 11.2153 24.6497 10.7096 24.2817ZM15.059 25.9514L15.369 22.9675C15.5755 22.9889 15.7859 23 16 23C16.2141 23 16.4245 22.9889 16.631 22.9675L16.941 25.9514C16.6318 25.9835 16.3178 26 16 26C15.6822 26 15.3683 25.9835 15.059 25.9514ZM19.6616 25.2239L18.4399 22.484C18.8238 22.3128 19.1874 22.1019 19.5251 21.8561L21.2904 24.2817C20.7847 24.6497 20.2392 24.9664 19.6616 25.2239ZM23.2817 22.2904L20.8561 20.525C21.1019 20.1873 21.3128 19.8238 21.484 19.4399L24.2239 20.6616C23.9664 21.2392 23.6497 21.7847 23.2817 22.2904Z" />
        <path fill="white" fill-opacity="0.75" fill-rule="evenodd" clip-rule="evenodd" d="M7.04861 16.059C7.01647 16.3683 7 16.6822 7 17C7 17.3178 7.01647 17.6317 7.04861 17.941L10.0325 17.631C10.0111 17.4245 10 17.2141 10 17C10 16.7859 10.0111 16.5755 10.0325 16.369L7.04861 16.059Z" />
        <path fill="white" fill-opacity="0.5" fill-rule="evenodd" clip-rule="evenodd" d="M8.71829 11.7096L11.1439 13.475C10.8981 13.8127 10.6873 14.1762 10.516 14.5601L7.77609 13.3384C8.03365 12.7608 8.35028 12.2153 8.71829 11.7096Z" />
        <path fill="white" fill-opacity="0.25" fill-rule="evenodd" clip-rule="evenodd" d="M12.3384 8.77608L13.5601 11.516C13.1762 11.6872 12.8127 11.8981 12.4749 12.1439L10.7096 9.71828C11.2153 9.35027 11.7608 9.03364 12.3384 8.77608Z" fill="white" />
        <path class="map-pin-fill" fill="white" fill-opacity="0.25" fill-rule="evenodd" clip-rule="evenodd" d="M19.7071 14.2929C20.0976 14.6834 20.0976 15.3166 19.7071 15.7071L15.7071 19.7071C15.3166 20.0976 14.6834 20.0976 14.2929 19.7071L12.2929 17.7071C11.9024 17.3166 11.9024 16.6834 12.2929 16.2929C12.6834 15.9024 13.3166 15.9024 13.7071 16.2929L15 17.5858L18.2929 14.2929C18.6834 13.9024 19.3166 13.9024 19.7071 14.2929Z"/>
        `,
        className,
        appealLabel,
      )
    case 'reject':
      return getDefaultMapPinIcon(
        `
        <path class="map-pin-fill" fill-rule="evenodd" clip-rule="evenodd" d="M5.49102 27.1756C-0.497014 21.1876 -0.497014 11.4791 5.49102 5.49103C11.4791 -0.497009 21.1876 -0.497009 27.1756 5.49103C33.1637 11.4791 33.1637 21.1876 27.1756 27.1756L17.7444 36.6069C16.9633 37.388 15.7034 37.388 14.9224 36.607L5.49102 27.1756Z"/>
        <path class="map-pin-ring" fill="white" fill-rule="evenodd" clip-rule="evenodd" d="M4.78392 4.78392C11.1625 -1.59464 21.5042 -1.59464 27.8827 4.78392C34.2613 11.1625 34.2613 21.5042 27.8827 27.8827L18.4515 37.314C17.2799 38.4855 15.3869 38.4857 14.2153 37.3141L4.78392 27.8827C-1.59464 21.5042 -1.59464 11.1625 4.78392 4.78392ZM26.4685 6.19814C20.871 0.600621 11.7957 0.600621 6.19814 6.19814C0.600621 11.7957 0.600621 20.871 6.19814 26.4685L15.6295 35.8999C16.02 36.2904 16.6467 36.2904 17.0373 35.8998L26.4685 26.4685C32.066 20.871 32.066 11.7957 26.4685 6.19814Z"/>
        <path d="M10 23L22 11M10 11L22 23" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
        `,
        className,
        appealLabel,
      )
    case 'blacklist':
      return getDefaultMapPinIcon(
        `
        <path fill="#111826" fill-rule="evenodd" clip-rule="evenodd" d="M16 17.237C16 15.4493 17.4391 14 19.2143 14H29.9286C30.3344 14 30.7054 14.2309 30.8869 14.5965C31.0684 14.962 31.0292 15.3995 30.7857 15.7264L28.0536 19.3951L30.7857 23.0637C31.0292 23.3907 31.0684 23.8281 30.8869 24.1937C30.7054 24.5592 30.3344 24.7901 29.9286 24.7901H19.2143C18.6226 24.7901 18.1429 25.2732 18.1429 25.8691V34.921C18.1429 35.5169 17.6632 36 17.0714 36C16.4797 36 16 35.5169 16 34.921V17.237Z"/>
        <path class="map-pin-ring" fill="white" fill-rule="evenodd" clip-rule="evenodd" d="M14 17.237C14 14.358 16.3212 12 19.2143 12H29.9286C31.0995 12 32.1614 12.6661 32.6782 13.7071C33.1941 14.7462 33.0837 15.9892 32.3898 16.921L30.5473 19.3951L32.3898 21.8691C33.0837 22.8009 33.1941 24.0439 32.6782 25.083C32.1614 26.124 31.0995 26.7901 29.9286 26.7901H20.1429V34.921C20.1429 36.6082 18.781 38 17.0714 38C15.3619 38 14 36.6082 14 34.921V17.237ZM28.0536 19.3951L30.7857 15.7264C31.0292 15.3995 31.0684 14.962 30.8869 14.5965C30.7054 14.2309 30.3344 14 29.9286 14H19.2143C17.4391 14 16 15.4493 16 17.237V34.921C16 35.5169 16.4797 36 17.0714 36C17.6632 36 18.1429 35.5169 18.1429 34.921V25.8691C18.1429 25.2732 18.6226 24.7901 19.2143 24.7901H29.9286C30.3344 24.7901 30.7054 24.5592 30.8869 24.1937C31.0684 23.8281 31.0292 23.3907 30.7857 23.0637L28.0536 19.3951Z"/>
        `,
        className,
        appealLabel,
      )
    default:
      return getDefaultMapPinIcon(
        `
        <path class="map-pin-${className} map-pin-fill" fill-rule="evenodd" clip-rule="evenodd" d="M5.49103 27.1756C-0.497009 21.1876 -0.497009 11.4791 5.49103 5.49103C11.4791 -0.49701 21.1876 -0.49701 27.1756 5.49103C33.1637 11.4791 33.1637 21.1876 27.1756 27.1756L17.7444 36.6069C16.9633 37.388 15.7034 37.388 14.9224 36.607L5.49103 27.1756ZM16.3333 22.0833C19.509 22.0833 22.0833 19.509 22.0833 16.3333C22.0833 13.1577 19.509 10.5833 16.3333 10.5833C13.1577 10.5833 10.5833 13.1577 10.5833 16.3333C10.5833 19.509 13.1577 22.0833 16.3333 22.0833Z"/>
        <path class="map-pin-ring" fill-rule="evenodd" clip-rule="evenodd" d="M4.78392 4.78392C11.1625 -1.59464 21.5042 -1.59464 27.8827 4.78392C34.2613 11.1625 34.2613 21.5042 27.8827 27.8827L18.4515 37.314C17.2799 38.4855 15.3869 38.4857 14.2153 37.3141L4.78392 27.8827C-1.59464 21.5042 -1.59464 11.1625 4.78392 4.78392ZM26.4685 6.19814C20.871 0.600621 11.7957 0.600621 6.19814 6.19814C0.600621 11.7957 0.600621 20.871 6.19814 26.4685L15.6295 35.8999C16.02 36.2904 16.6467 36.2904 17.0373 35.8998L26.4685 26.4685C32.066 20.871 32.066 11.7957 26.4685 6.19814ZM16.3333 11.5833C13.71 11.5833 11.5833 13.71 11.5833 16.3333C11.5833 18.9567 13.71 21.0833 16.3333 21.0833C18.9567 21.0833 21.0833 18.9567 21.0833 16.3333C21.0833 13.71 18.9567 11.5833 16.3333 11.5833ZM9.58334 16.3333C9.58334 12.6054 12.6054 9.58333 16.3333 9.58333C20.0613 9.58333 23.0833 12.6054 23.0833 16.3333C23.0833 20.0613 20.0613 23.0833 16.3333 23.0833C12.6054 23.0833 9.58334 20.0613 9.58334 16.3333Z" fill="white"/>
        `,
        className,
        appealLabel,
      )
  }
}

const getDefaultMapPinIcon = (
  svg: string,
  className = 'default',
  appealLabel = '',
) =>
  L.divIcon({
    className: `map-pin-container map-pin-${className}`,
    iconSize: [30, 35],
    iconAnchor: [15, 35],
    popupAnchor: [0, -25],
    tooltipAnchor: [0, -22],
    html: `
    <svg width="33" height="39" viewBox="0 0 33 39" class="map-pin" fill="none" xmlns="http://www.w3.org/2000/svg">
    ${svg}
    </svg>
    ${appealLabel}
  `,
  })
